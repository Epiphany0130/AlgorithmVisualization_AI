<template>
  <div class="dfs-learning">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="learning-header">
      <el-steps :active="currentStep" align-center>
        <el-step title="ç®—æ³•ä»‹ç»" description="äº†è§£DFSåŸºæœ¬æ¦‚å¿µ"></el-step>
        <el-step title="ä»£ç æ¨¡æ¿" description="å­¦ä¹ DFSä»£ç ç»“æ„"></el-step>
        <el-step title="å¯è§†åŒ–æ¼”ç¤º" description="è§‚çœ‹ç®—æ³•æ‰§è¡Œè¿‡ç¨‹"></el-step>
        <el-step title="äº¤äº’ç»ƒä¹ " description="åŠ¨æ‰‹å®è·µæ“ä½œ"></el-step>
      </el-steps>
    </div>

    <!-- è¯­è¨€é€‰æ‹©å™¨ -->
    <div class="language-selector">
      <el-radio-group v-model="selectedLanguage" @change="onLanguageChange">
        <el-radio-button label="cpp">C++</el-radio-button>
        <el-radio-button label="java">Java</el-radio-button>
      </el-radio-group>
    </div>

    <!-- æ­¥éª¤1: ç®—æ³•ä»‹ç» -->
    <div v-if="currentStep === 0" class="step-content">
      <el-card class="intro-card">
        <h2>æ·±åº¦ä¼˜å…ˆæœç´¢ (DFS) ç®—æ³•ä»‹ç»</h2>
        <div class="intro-content">
          <div class="concept-section">
            <h3>ğŸ¤” ä»€ä¹ˆæ˜¯DFSï¼Ÿ</h3>
            <p>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDepth-First Searchï¼ŒDFSï¼‰æ˜¯ä¸€ç§ç”¨äºéå†æˆ–æœç´¢æ ‘æˆ–å›¾çš„ç®—æ³•ã€‚å®ƒä¼šå°½å¯èƒ½æ·±åœ°æœç´¢æ ‘çš„åˆ†æ”¯ã€‚</p>
            
            <h3>ğŸ¯ DFSçš„æ ¸å¿ƒæ€æƒ³</h3>
            <ul>
              <li><strong>æ·±åº¦ä¼˜å…ˆ</strong>ï¼šä¼˜å…ˆè®¿é—®æ›´æ·±å±‚çš„èŠ‚ç‚¹</li>
              <li><strong>é€’å½’å®ç°</strong>ï¼šåˆ©ç”¨å‡½æ•°è°ƒç”¨æ ˆå®ç°å›æº¯</li>
              <li><strong>å›æº¯æœºåˆ¶</strong>ï¼šå½“æ— è·¯å¯èµ°æ—¶ï¼Œè¿”å›ä¸Šä¸€å±‚ç»§ç»­æœç´¢</li>
            </ul>

            <h3>ğŸ“š DFSä¸‰éƒ¨æ›²</h3>
            <div class="trilogy">
              <div class="trilogy-item">
                <div class="step-number">1</div>
                <div class="step-content">
                  <h4>ç¡®å®šå‡½æ•°å’Œå‚æ•°</h4>
                  <p>å®šä¹‰é€’å½’å‡½æ•°çš„å‚æ•°ï¼Œé€šå¸¸åŒ…æ‹¬å½“å‰èŠ‚ç‚¹ã€å›¾ç»“æ„ç­‰</p>
                </div>
              </div>
              <div class="trilogy-item">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h4>ç¡®å®šç»ˆæ­¢æ¡ä»¶</h4>
                  <p>ä»€ä¹ˆæ—¶å€™åœæ­¢é€’å½’ï¼Œé€šå¸¸æ˜¯æ‰¾åˆ°ç›®æ ‡æˆ–æ— è·¯å¯èµ°</p>
                </div>
              </div>
              <div class="trilogy-item">
                <div class="step-number">3</div>
                <div class="step-content">
                  <h4>å¤„ç†èŠ‚ç‚¹</h4>
                  <p>å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡Œå¤„ç†ï¼Œç„¶åé€’å½’è®¿é—®ç›¸é‚»èŠ‚ç‚¹</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="step-actions">
          <el-button type="primary" size="large" @click="nextStep">
            ä¸‹ä¸€æ­¥ï¼šå­¦ä¹ ä»£ç æ¨¡æ¿
            <el-icon><ArrowRight /></el-icon>
          </el-button>
        </div>
      </el-card>
    </div>

    <!-- æ­¥éª¤2: ä»£ç æ¨¡æ¿ -->
    <div v-if="currentStep === 1" class="step-content">
      <el-card class="code-card">
        <h2>DFS ä»£ç æ¨¡æ¿å­¦ä¹ </h2>
        <div class="code-explanation">
          <h3>ğŸ“ æ ‡å‡†DFSæ¨¡æ¿</h3>
          <p>è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ DFSçš„æ ‡å‡†å®ç°æ¨¡æ¿ï¼š</p>
          
          <div class="code-container">
            <pre class="code-block" v-if="selectedLanguage === 'cpp'"><code>// C++ DFS æ¨¡æ¿
#include &lt;vector&gt;
using namespace std;

vector&lt;vector&lt;int&gt;&gt; result;  // å­˜å‚¨æ‰€æœ‰ç»“æœ
vector&lt;int&gt; path;           // å½“å‰è·¯å¾„

void dfs(å›¾çš„æ•°æ®ç»“æ„, å½“å‰æœç´¢çš„èŠ‚ç‚¹) {
    // 1. ç»ˆæ­¢æ¡ä»¶
    if (æ»¡è¶³ç»ˆæ­¢æ¡ä»¶) {
        result.push_back(path);  // å­˜æ”¾ç»“æœ
        return;
    }
    
    // 2. éå†æ‰€æœ‰å¯èƒ½çš„é€‰æ‹©
    for (éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ç›¸é‚»èŠ‚ç‚¹) {
        // 3. åšé€‰æ‹©
        path.push_back(å½“å‰é€‰æ‹©);
        
        // 4. é€’å½’è°ƒç”¨
        dfs(å›¾, é€‰æ‹©çš„èŠ‚ç‚¹);
        
        // 5. æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯ï¼‰
        path.pop_back();
    }
}</code></pre>
            
            <pre class="code-block" v-if="selectedLanguage === 'java'"><code>// Java DFS æ¨¡æ¿
import java.util.*;

public class DFS {
    List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();  // å­˜å‚¨æ‰€æœ‰ç»“æœ
    List&lt;Integer&gt; path = new ArrayList&lt;&gt;();         // å½“å‰è·¯å¾„
    
    public void dfs(å›¾çš„æ•°æ®ç»“æ„, å½“å‰æœç´¢çš„èŠ‚ç‚¹) {
        // 1. ç»ˆæ­¢æ¡ä»¶
        if (æ»¡è¶³ç»ˆæ­¢æ¡ä»¶) {
            result.add(new ArrayList&lt;&gt;(path));  // å­˜æ”¾ç»“æœ
            return;
        }
        
        // 2. éå†æ‰€æœ‰å¯èƒ½çš„é€‰æ‹©
        for (éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ç›¸é‚»èŠ‚ç‚¹) {
            // 3. åšé€‰æ‹©
            path.add(å½“å‰é€‰æ‹©);
            
            // 4. é€’å½’è°ƒç”¨
            dfs(å›¾, é€‰æ‹©çš„èŠ‚ç‚¹);
            
            // 5. æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯ï¼‰
            path.remove(path.size() - 1);
        }
    }
}</code></pre>
          </div>

          <div class="code-explanation-details">
            <h3>ğŸ” ä»£ç è¯¦è§£</h3>
            <div class="explanation-item" v-for="(item, index) in codeExplanations" :key="index">
              <div class="explanation-number">{{ index + 1 }}</div>
              <div class="explanation-content">
                <h4>{{ item.title }}</h4>
                <p>{{ item.description }}</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <el-button @click="prevStep">ä¸Šä¸€æ­¥</el-button>
          <el-button type="primary" size="large" @click="nextStep">
            ä¸‹ä¸€æ­¥ï¼šå¯è§†åŒ–æ¼”ç¤º
            <el-icon><ArrowRight /></el-icon>
          </el-button>
        </div>
      </el-card>
    </div>

    <!-- æ­¥éª¤3: å¯è§†åŒ–æ¼”ç¤º -->
    <div v-if="currentStep === 2" class="step-content">
      <el-card class="visualization-card">
        <h2>DFS å¯è§†åŒ–æ¼”ç¤º</h2>
        <div class="visualization-content">
          <div class="demo-controls">
            <el-button type="primary" @click="startDemo" :disabled="isPlaying">
              <el-icon><VideoPlay /></el-icon>
              å¼€å§‹æ¼”ç¤º
            </el-button>
            <el-button @click="pauseDemo" :disabled="!isPlaying">
              <el-icon><VideoPause /></el-icon>
              æš‚åœ
            </el-button>
            <el-button @click="resetDemo">
              <el-icon><RefreshRight /></el-icon>
              é‡ç½®
            </el-button>
            <el-slider
              v-model="playSpeed"
              :min="1"
              :max="5"
              :step="1"
              show-stops
              style="width: 200px; margin-left: 20px;"
            >
              <template #default="{ value }">
                <span>é€Ÿåº¦: {{ value }}x</span>
              </template>
            </el-slider>
          </div>

          <div class="demo-area">
            <div class="graph-container">
              <svg width="600" height="400" class="graph-svg">
                <!-- è¾¹ -->
                <g class="edges">
                  <line v-for="edge in edges" :key="edge.id"
                    :x1="nodes[edge.from].x" :y1="nodes[edge.from].y"
                    :x2="nodes[edge.to].x" :y2="nodes[edge.to].y"
                    :class="['edge', { 'visited': edge.visited }]"
                  />
                </g>
                <!-- èŠ‚ç‚¹ -->
                <g class="nodes">
                  <circle v-for="node in nodes" :key="node.id"
                    :cx="node.x" :cy="node.y" :r="25"
                    :class="['node', node.status]"
                  />
                  <text v-for="node in nodes" :key="'text-' + node.id"
                    :x="node.x" :y="node.y + 5"
                    class="node-text"
                  >
                    {{ node.label }}
                  </text>
                </g>
              </svg>
            </div>
            
            <div class="demo-info">
              <div class="current-step-info">
                <h3>å½“å‰æ­¥éª¤</h3>
                <p>{{ currentDemoStep }}</p>
              </div>
              <div class="stack-info">
                <h3>è°ƒç”¨æ ˆ</h3>
                <div class="stack">
                  <div v-for="(call, index) in callStack" :key="index" class="stack-item">
                    dfs({{ call }})
                  </div>
                </div>
              </div>
              <div class="path-info">
                <h3>å½“å‰è·¯å¾„</h3>
                <div class="path">
                  <el-tag v-for="node in currentPath" :key="node" type="primary">{{ node }}</el-tag>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <el-button @click="prevStep">ä¸Šä¸€æ­¥</el-button>
          <el-button type="primary" size="large" @click="nextStep">
            ä¸‹ä¸€æ­¥ï¼šäº¤äº’ç»ƒä¹ 
            <el-icon><ArrowRight /></el-icon>
          </el-button>
        </div>
      </el-card>
      
      <!-- å²›å±¿æ•°é‡é—®é¢˜æ¼”ç¤º -->
      <el-card class="island-demo-card" style="margin-top: 20px;">
        <h2>ğŸï¸ LeetCode 200é¢˜ï¼šå²›å±¿æ•°é‡</h2>
        
        <!-- é¢˜ç›®æè¿° -->
        <div class="problem-description">
          <h3>ğŸ“‹ é¢˜ç›®æè¿°</h3>
          <el-alert type="info" :closable="false">
            <p><strong>ç»™ä½ ä¸€ä¸ªç”± '1'ï¼ˆé™†åœ°ï¼‰å’Œ '0'ï¼ˆæ°´ï¼‰ç»„æˆçš„çš„äºŒç»´ç½‘æ ¼ï¼Œè¯·ä½ è®¡ç®—ç½‘æ ¼ä¸­å²›å±¿çš„æ•°é‡ã€‚</strong></p>
            <p>å²›å±¿æ€»æ˜¯è¢«æ°´åŒ…å›´ï¼Œå¹¶ä¸”æ¯åº§å²›å±¿åªèƒ½ç”±æ°´å¹³æ–¹å‘å’Œ/æˆ–ç«–ç›´æ–¹å‘ä¸Šç›¸é‚»çš„é™†åœ°è¿æ¥å½¢æˆã€‚</p>
            <p>æ­¤å¤–ï¼Œä½ å¯ä»¥å‡è®¾è¯¥ç½‘æ ¼çš„å››æ¡è¾¹å‡è¢«æ°´åŒ…å›´ã€‚</p>
          </el-alert>
          
          <div class="example-section">
            <h4>ç¤ºä¾‹ 1ï¼š</h4>
            <pre class="example-code">
è¾“å…¥ï¼šgrid = [
  ["1","1","1","1","0"],
  ["1","1","0","1","0"],
  ["1","1","0","0","0"],
  ["0","0","0","0","0"]
]
è¾“å‡ºï¼š1
            </pre>
            
            <h4>ç¤ºä¾‹ 2ï¼š</h4>
            <pre class="example-code">
è¾“å…¥ï¼šgrid = [
  ["1","1","0","0","0"],
  ["1","1","0","0","0"],
  ["0","0","1","0","0"],
  ["0","0","0","1","1"]
]
è¾“å‡ºï¼š3
            </pre>
          </div>
        </div>
        
        <!-- å¯è§†åŒ–æ¼”ç¤º -->
        <div class="island-visualization">
          <h3>ğŸ¬ å¯è§†åŒ–æ¼”ç¤º</h3>
          <div class="island-controls">
            <el-button type="primary" @click="startIslandDemo" :disabled="isIslandPlaying">
              <el-icon><VideoPlay /></el-icon>
              å¼€å§‹æ¼”ç¤º
            </el-button>
            <el-button @click="pauseIslandDemo" :disabled="!isIslandPlaying">
              <el-icon><VideoPause /></el-icon>
              æš‚åœ
            </el-button>
            <el-button @click="resetIslandDemo">
              <el-icon><RefreshRight /></el-icon>
              é‡ç½®
            </el-button>
            <el-select v-model="selectedExample" @change="loadExample" style="margin-left: 20px;">
              <el-option label="ç¤ºä¾‹ 1" value="example1"></el-option>
              <el-option label="ç¤ºä¾‹ 2" value="example2"></el-option>
            </el-select>
          </div>
          
          <div class="island-demo-area">
            <div class="grid-container">
              <div class="grid">
                <div 
                  v-for="(row, i) in islandGrid" 
                  :key="i" 
                  class="grid-row"
                >
                  <div 
                    v-for="(cell, j) in row" 
                    :key="j" 
                    :class="['grid-cell', {
                      'land': cell === '1',
                      'water': cell === '0',
                      'visiting': islandVisiting[i] && islandVisiting[i][j],
                      'visited': islandVisited[i] && islandVisited[i][j]
                    }]"
                  >
                    {{ cell }}
                  </div>
                </div>
              </div>
            </div>
            
            <div class="island-info">
              <div class="island-stats">
                <h4>ç»Ÿè®¡ä¿¡æ¯</h4>
                <p><strong>å½“å‰å²›å±¿æ•°é‡ï¼š</strong> {{ islandCount }}</p>
                <p><strong>å½“å‰ä½ç½®ï¼š</strong> {{ currentIslandPosition }}</p>
                <p><strong>å½“å‰æ“ä½œï¼š</strong> {{ currentIslandAction }}</p>
              </div>
              
              <div class="dfs-stack">
                <h4>DFS è°ƒç”¨æ ˆ</h4>
                <div class="stack">
                  <div v-for="(call, index) in islandCallStack" :key="index" class="stack-item">
                    dfs({{ call.row }}, {{ call.col }})
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ä»£ç å®ç° -->
        <div class="island-code-section">
          <h3>ğŸ’» ä»£ç å®ç°</h3>
          <el-tabs v-model="islandCodeLanguage">
            <el-tab-pane label="C++" name="cpp">
              <pre class="code-block"><code class="cpp">class Solution {
public:
    int numIslands(vector&lt;vector&lt;char&gt;&gt;&amp; grid) {
        if (grid.empty() || grid[0].empty()) {
            return 0;
        }
        
        int m = grid.size();
        int n = grid[0].size();
        int count = 0;
        
        // éå†æ•´ä¸ªç½‘æ ¼
        for (int i = 0; i &lt; m; i++) {
            for (int j = 0; j &lt; n; j++) {
                // å‘ç°é™†åœ°ï¼Œå¼€å§‹DFS
                if (grid[i][j] == '1') {
                    count++;
                    dfs(grid, i, j);
                }
            }
        }
        
        return count;
    }
    
private:
    void dfs(vector&lt;vector&lt;char&gt;&gt;&amp; grid, int i, int j) {
        int m = grid.size();
        int n = grid[0].size();
        
        // è¾¹ç•Œæ£€æŸ¥å’Œç»ˆæ­¢æ¡ä»¶
        if (i &lt; 0 || i &gt;= m || j &lt; 0 || j &gt;= n || grid[i][j] != '1') {
            return;
        }
        
        // æ ‡è®°å½“å‰é™†åœ°ä¸ºå·²è®¿é—®
        grid[i][j] = '0';
        
        // é€’å½’è®¿é—®å››ä¸ªæ–¹å‘
        dfs(grid, i - 1, j); // ä¸Š
        dfs(grid, i + 1, j); // ä¸‹
        dfs(grid, i, j - 1); // å·¦
        dfs(grid, i, j + 1); // å³
    }
};</code></pre>
            </el-tab-pane>
            
            <el-tab-pane label="Java" name="java">
              <pre class="code-block"><code class="java">class Solution {
    public int numIslands(char[][] grid) {
        if (grid == null || grid.length == 0 || grid[0].length == 0) {
            return 0;
        }
        
        int m = grid.length;
        int n = grid[0].length;
        int count = 0;
        
        // éå†æ•´ä¸ªç½‘æ ¼
        for (int i = 0; i &lt; m; i++) {
            for (int j = 0; j &lt; n; j++) {
                // å‘ç°é™†åœ°ï¼Œå¼€å§‹DFS
                if (grid[i][j] == '1') {
                    count++;
                    dfs(grid, i, j);
                }
            }
        }
        
        return count;
    }
    
    private void dfs(char[][] grid, int i, int j) {
        int m = grid.length;
        int n = grid[0].length;
        
        // è¾¹ç•Œæ£€æŸ¥å’Œç»ˆæ­¢æ¡ä»¶
        if (i &lt; 0 || i &gt;= m || j &lt; 0 || j &gt;= n || grid[i][j] != '1') {
            return;
        }
        
        // æ ‡è®°å½“å‰é™†åœ°ä¸ºå·²è®¿é—®
        grid[i][j] = '0';
        
        // é€’å½’è®¿é—®å››ä¸ªæ–¹å‘
        dfs(grid, i - 1, j); // ä¸Š
        dfs(grid, i + 1, j); // ä¸‹
        dfs(grid, i, j - 1); // å·¦
        dfs(grid, i, j + 1); // å³
    }
}</code></pre>
            </el-tab-pane>
          </el-tabs>
        </div>
        
        <!-- é¢˜è§£åˆ†æ -->
        <div class="island-solution">
          <h3>ğŸ§  é¢˜è§£åˆ†æ</h3>
          <el-collapse>
            <el-collapse-item title="ç®—æ³•æ€è·¯" name="1">
              <div class="solution-content">
                <h4>æ ¸å¿ƒæ€æƒ³ï¼š</h4>
                <p>ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥è§£å†³å²›å±¿æ•°é‡é—®é¢˜ã€‚æ¯å½“æˆ‘ä»¬é‡åˆ°ä¸€ä¸ªæœªè®¿é—®çš„é™†åœ°ï¼ˆ'1'ï¼‰ï¼Œå°±å¼€å§‹ä¸€æ¬¡DFSï¼Œå°†ä¸å…¶è¿é€šçš„æ‰€æœ‰é™†åœ°éƒ½æ ‡è®°ä¸ºå·²è®¿é—®ï¼Œè¿™æ ·å°±æ‰¾åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„å²›å±¿ã€‚</p>
                
                <h4>ç®—æ³•æ­¥éª¤ï¼š</h4>
                <ol>
                  <li><strong>éå†ç½‘æ ¼ï¼š</strong>é€ä¸ªæ£€æŸ¥ç½‘æ ¼ä¸­çš„æ¯ä¸ªä½ç½®</li>
                  <li><strong>å‘ç°é™†åœ°ï¼š</strong>å½“é‡åˆ°å€¼ä¸º'1'çš„ä½ç½®æ—¶ï¼Œè¯´æ˜å‘ç°äº†æ–°å²›å±¿</li>
                  <li><strong>DFSæ ‡è®°ï¼š</strong>ä»è¯¥ä½ç½®å¼€å§‹DFSï¼Œå°†æ‰€æœ‰è¿é€šçš„é™†åœ°æ ‡è®°ä¸º'0'</li>
                  <li><strong>è®¡æ•°å¢åŠ ï¼š</strong>æ¯æ¬¡DFSå®Œæˆåï¼Œå²›å±¿è®¡æ•°åŠ 1</li>
                  <li><strong>ç»§ç»­éå†ï¼š</strong>ç»§ç»­éå†å‰©ä½™ä½ç½®ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹</li>
                </ol>
              </div>
            </el-collapse-item>
            
            <el-collapse-item title="æ—¶é—´å¤æ‚åº¦åˆ†æ" name="2">
              <div class="solution-content">
                <p><strong>æ—¶é—´å¤æ‚åº¦ï¼šO(M Ã— N)</strong></p>
                <p>å…¶ä¸­ M å’Œ N åˆ†åˆ«æ˜¯ç½‘æ ¼çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚åœ¨æœ€åæƒ…å†µä¸‹ï¼Œæ•´ä¸ªç½‘æ ¼éƒ½æ˜¯é™†åœ°ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®æ¯ä¸ªä½ç½®ä¸€æ¬¡ã€‚</p>
                
                <p><strong>ç©ºé—´å¤æ‚åº¦ï¼šO(M Ã— N)</strong></p>
                <p>åœ¨æœ€åæƒ…å†µä¸‹ï¼ˆæ•´ä¸ªç½‘æ ¼éƒ½æ˜¯é™†åœ°ä¸”å‘ˆä¸€æ¡ç›´çº¿ï¼‰ï¼Œé€’å½’è°ƒç”¨æ ˆçš„æ·±åº¦å¯èƒ½è¾¾åˆ° M Ã— Nã€‚</p>
              </div>
            </el-collapse-item>
            
            <el-collapse-item title="å…³é”®æŠ€å·§" name="3">
              <div class="solution-content">
                <h4>1. åŸåœ°æ ‡è®°</h4>
                <p>ç›´æ¥ä¿®æ”¹åŸç½‘æ ¼ï¼Œå°†è®¿é—®è¿‡çš„é™†åœ°æ ‡è®°ä¸º'0'ï¼Œé¿å…ä½¿ç”¨é¢å¤–çš„visitedæ•°ç»„ã€‚</p>
                
                <h4>2. å››æ–¹å‘éå†</h4>
                <p>ä½¿ç”¨æ–¹å‘æ•°ç»„æˆ–ç›´æ¥é€’å½’è°ƒç”¨å››ä¸ªæ–¹å‘ï¼Œç¡®ä¿è®¿é—®æ‰€æœ‰ç›¸é‚»çš„é™†åœ°ã€‚</p>
                
                <h4>3. è¾¹ç•Œæ£€æŸ¥</h4>
                <p>åœ¨DFSå‡½æ•°å¼€å§‹æ—¶è¿›è¡Œè¾¹ç•Œæ£€æŸ¥å’Œç»ˆæ­¢æ¡ä»¶åˆ¤æ–­ï¼Œé¿å…è¶Šç•Œè®¿é—®ã€‚</p>
                
                <h4>4. å˜ä½“æ‰©å±•</h4>
                <p>è¿™ä¸ªæ¨¡æ¿å¯ä»¥æ‰©å±•åˆ°å…¶ä»–ç±»ä¼¼é—®é¢˜ï¼Œå¦‚å²›å±¿å‘¨é•¿ã€æœ€å¤§å²›å±¿é¢ç§¯ç­‰ã€‚</p>
              </div>
            </el-collapse-item>
          </el-collapse>
        </div>
      </el-card>
    </div>

    <!-- æ­¥éª¤4: äº¤äº’ç»ƒä¹  -->
    <div v-if="currentStep === 3" class="step-content">
      <el-card class="practice-card">
        <h2>DFS äº¤äº’ç»ƒä¹ </h2>
        <div class="practice-content">
          <div class="practice-instructions">
            <h3>ğŸ® ç»ƒä¹ è¯´æ˜</h3>
            <p>ç°åœ¨è½®åˆ°ä½ æ¥æ“ä½œäº†ï¼ç‚¹å‡»èŠ‚ç‚¹æ¥æ¨¡æ‹ŸDFSçš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p>
            <div class="practice-rules">
              <el-alert title="ç»ƒä¹ è§„åˆ™" type="info" :closable="false">
                <ul>
                  <li>ä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼ŒæŒ‰ç…§DFSçš„è§„åˆ™è®¿é—®èŠ‚ç‚¹</li>
                  <li>ä¼˜å…ˆè®¿é—®æ›´æ·±å±‚çš„èŠ‚ç‚¹</li>
                  <li>å½“æ— è·¯å¯èµ°æ—¶ï¼Œéœ€è¦å›æº¯åˆ°ä¸Šä¸€å±‚</li>
                  <li>æ­£ç¡®å®Œæˆæ‰€æœ‰æ­¥éª¤å³å¯é€šè¿‡ç»ƒä¹ </li>
                </ul>
              </el-alert>
            </div>
          </div>

          <div class="practice-area">
            <div class="practice-graph">
              <svg width="600" height="400" class="practice-svg">
                <!-- è¾¹ -->
                <g class="edges">
                  <line v-for="edge in practiceEdges" :key="edge.id"
                    :x1="practiceNodes[edge.from].x" :y1="practiceNodes[edge.from].y"
                    :x2="practiceNodes[edge.to].x" :y2="practiceNodes[edge.to].y"
                    :class="['edge', { 'visited': edge.visited }]"
                  />
                </g>
                <!-- èŠ‚ç‚¹ -->
                <g class="nodes">
                  <circle v-for="node in practiceNodes" :key="node.id"
                    :cx="node.x" :cy="node.y" :r="25"
                    :class="['node', 'practice-node', node.status]"
                    @click="onNodeClick(node)"
                  />
                  <text v-for="node in practiceNodes" :key="'text-' + node.id"
                    :x="node.x" :y="node.y + 5"
                    class="node-text"
                  >
                    {{ node.label }}
                  </text>
                </g>
              </svg>
            </div>
            
            <div class="practice-info">
              <div class="practice-progress">
                <h3>ç»ƒä¹ è¿›åº¦</h3>
                <el-progress :percentage="practiceProgress" :status="practiceStatus"></el-progress>
              </div>
              <div class="practice-feedback">
                <h3>æ“ä½œåé¦ˆ</h3>
                <div class="feedback-message" :class="feedbackType">
                  {{ feedbackMessage }}
                </div>
              </div>
              <div class="practice-actions">
                <el-button @click="resetPractice">
                  <el-icon><RefreshRight /></el-icon>
                  é‡æ–°å¼€å§‹
                </el-button>
                <el-button type="success" @click="showHint">
                  <el-icon><QuestionFilled /></el-icon>
                  æç¤º
                </el-button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <el-button @click="prevStep">ä¸Šä¸€æ­¥</el-button>
          <el-button type="success" size="large" @click="completeLearning">
            å®Œæˆå­¦ä¹ 
            <el-icon><Check /></el-icon>
          </el-button>
        </div>
      </el-card>
    </div>
  </div>
</template>

<script>
import {
  VideoPlay,
  VideoPause,
  RefreshRight,
  ArrowRight,
  QuestionFilled,
  Check
} from '@element-plus/icons-vue'

export default {
  components: {
    VideoPlay,
    VideoPause,
    RefreshRight,
    ArrowRight,
    QuestionFilled,
    Check
  },
  name: 'DFSLearning',
  data() {
    return {
      currentStep: 0,
      selectedLanguage: 'cpp',
      isPlaying: false,
      playSpeed: 2,
      currentDemoStep: 'å‡†å¤‡å¼€å§‹DFSæ¼”ç¤º...',
      callStack: [],
      currentPath: [],
      
      // ä»£ç è§£é‡Š
      codeExplanations: [
        {
          title: 'ç»ˆæ­¢æ¡ä»¶',
          description: 'å®šä¹‰ä»€ä¹ˆæ—¶å€™åœæ­¢é€’å½’ï¼Œè¿™æ˜¯é€’å½’å‡½æ•°çš„åŸºç¡€ã€‚é€šå¸¸æ˜¯æ‰¾åˆ°ç›®æ ‡æˆ–è€…æ— è·¯å¯èµ°æ—¶ã€‚'
        },
        {
          title: 'éå†é€‰æ‹©',
          description: 'éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ç›¸é‚»èŠ‚ç‚¹ï¼Œè¿™å†³å®šäº†æœç´¢çš„æ–¹å‘å’ŒèŒƒå›´ã€‚'
        },
        {
          title: 'åšé€‰æ‹©',
          description: 'å°†å½“å‰é€‰æ‹©åŠ å…¥è·¯å¾„ï¼Œè¿™æ˜¯å‘å‰æœç´¢çš„å…³é”®æ­¥éª¤ã€‚'
        },
        {
          title: 'é€’å½’è°ƒç”¨',
          description: 'å¯¹é€‰æ‹©çš„èŠ‚ç‚¹ç»§ç»­è¿›è¡ŒDFSï¼Œè¿™ä½“ç°äº†æ·±åº¦ä¼˜å…ˆçš„ç‰¹ç‚¹ã€‚'
        },
        {
          title: 'æ’¤é”€é€‰æ‹©',
          description: 'å›æº¯æ—¶æ’¤é”€ä¹‹å‰çš„é€‰æ‹©ï¼Œè¿™æ˜¯å›æº¯ç®—æ³•çš„æ ¸å¿ƒæœºåˆ¶ã€‚'
        }
      ],
      
      // æ¼”ç¤ºå›¾çš„èŠ‚ç‚¹
      nodes: {
        'A': { id: 'A', label: 'A', x: 100, y: 100, status: 'unvisited' },
        'B': { id: 'B', label: 'B', x: 200, y: 200, status: 'unvisited' },
        'C': { id: 'C', label: 'C', x: 300, y: 100, status: 'unvisited' },
        'D': { id: 'D', label: 'D', x: 150, y: 300, status: 'unvisited' },
        'E': { id: 'E', label: 'E', x: 400, y: 200, status: 'unvisited' },
        'F': { id: 'F', label: 'F', x: 500, y: 100, status: 'unvisited' }
      },
      
      // æ¼”ç¤ºå›¾çš„è¾¹
      edges: [
        { id: 1, from: 'A', to: 'B', visited: false },
        { id: 2, from: 'A', to: 'C', visited: false },
        { id: 3, from: 'B', to: 'D', visited: false },
        { id: 4, from: 'C', to: 'E', visited: false },
        { id: 5, from: 'C', to: 'F', visited: false }
      ],
      
      // ç»ƒä¹ ç›¸å…³
      practiceNodes: {},
      practiceEdges: [],
      practiceProgress: 0,
      practiceStatus: '',
      feedbackMessage: 'ç‚¹å‡»èµ·å§‹èŠ‚ç‚¹ A å¼€å§‹ç»ƒä¹ ',
      feedbackType: 'info',
      expectedSequence: ['A', 'B', 'D', 'C', 'E', 'F'],
      practiceGraph: {},
      userSequence: [],
      
      demoTimer: null,
      
      // å²›å±¿æ•°é‡æ¼”ç¤ºç›¸å…³
      isIslandPlaying: false,
      selectedExample: 'example1',
      islandCodeLanguage: 'cpp',
      islandGrid: [],
      islandVisiting: [],
      islandVisited: [],
      islandCount: 0,
      currentIslandPosition: '(0, 0)',
      currentIslandAction: 'å‡†å¤‡å¼€å§‹æ¼”ç¤º...',
      islandCallStack: [],
      islandDemoTimer: null,
      islandDemoSteps: [],
      islandCurrentStepIndex: 0,
      
      // ç¤ºä¾‹æ•°æ®
      examples: {
        example1: [
          ['1','1','1','1','0'],
          ['1','1','0','1','0'],
          ['1','1','0','0','0'],
          ['0','0','0','0','0']
        ],
        example2: [
          ['1','1','0','0','0'],
          ['1','1','0','0','0'],
          ['0','0','1','0','0'],
          ['0','0','0','1','1']
        ]
      }
    }
  },
  mounted() {
    // ä»æœ¬åœ°å­˜å‚¨è¯»å–è¯­è¨€é€‰æ‹©
    const savedLang = localStorage.getItem('selectedLanguage')
    if (savedLang) {
      this.selectedLanguage = savedLang
    }
    
    // åˆå§‹åŒ–ç»ƒä¹ å›¾
    this.initPractice()
    
    // åˆå§‹åŒ–å²›å±¿æ¼”ç¤º
    this.loadExample()
  },
  methods: {
    nextStep() {
      if (this.currentStep < 3) {
        this.currentStep++
      }
    },
    
    prevStep() {
      if (this.currentStep > 0) {
        this.currentStep--
      }
    },
    
    onLanguageChange(lang) {
      localStorage.setItem('selectedLanguage', lang)
    },
    
    // æ¼”ç¤ºç›¸å…³æ–¹æ³•
    startDemo() {
      this.isPlaying = true
      this.resetDemo(true)
      this.runDemoSequence()
    },
    
    pauseDemo() {
      this.isPlaying = false
      if (this.demoTimer) {
        clearTimeout(this.demoTimer)
      }
    },
    
    resetDemo(fromStart = false) {
      if (!fromStart) {
        this.isPlaying = false
      }
      
      if (this.demoTimer) {
        clearTimeout(this.demoTimer)
      }
      
      // é‡ç½®æ‰€æœ‰èŠ‚ç‚¹å’Œè¾¹çš„çŠ¶æ€
      Object.values(this.nodes).forEach(node => {
        node.status = 'unvisited'
      })
      this.edges.forEach(edge => {
        edge.visited = false
      })
      
      this.callStack = []
      this.currentPath = []
      this.currentDemoStep = 'å‡†å¤‡å¼€å§‹DFSæ¼”ç¤º...'
    },
    
    runDemoSequence() {
      // æ„å»ºé‚»æ¥è¡¨
      const graph = {}
      Object.keys(this.nodes).forEach(node => {
        graph[node] = []
      })
      
      this.edges.forEach(edge => {
        graph[edge.from].push(edge.to)
        graph[edge.to].push(edge.from) // æ— å‘å›¾
      })
      
      // DFSæ¼”ç¤ºæ­¥éª¤é˜Ÿåˆ—
      const steps = []
      const visited = new Set()
      
      // ç”ŸæˆDFSæ­¥éª¤
      const generateDFSSteps = (node, parent = null) => {
        steps.push({
          action: 'enter',
          node: node,
          step: `è¿›å…¥èŠ‚ç‚¹ ${node}ï¼Œå°†å…¶æ ‡è®°ä¸ºæ­£åœ¨è®¿é—®`
        })
        
        steps.push({
          action: 'visit',
          node: node,
          step: `è®¿é—®èŠ‚ç‚¹ ${node}ï¼ŒåŠ å…¥è°ƒç”¨æ ˆ`
        })
        
        visited.add(node)
        
        // æ ‡è®°ä»çˆ¶èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è¾¹
        if (parent) {
          steps.push({
            action: 'mark_edge',
            from: parent,
            to: node,
            step: `æ ‡è®°è¾¹ ${parent} â†’ ${node} ä¸ºå·²è®¿é—®`
          })
        }
        
        // éå†æ‰€æœ‰é‚»å±…
        const neighbors = graph[node].filter(neighbor => !visited.has(neighbor))
        
        if (neighbors.length === 0) {
          steps.push({
            action: 'no_neighbors',
            node: node,
            step: `èŠ‚ç‚¹ ${node} æ²¡æœ‰æœªè®¿é—®çš„é‚»å±…`
          })
        } else {
          steps.push({
            action: 'check_neighbors',
            node: node,
            neighbors: neighbors,
            step: `æ£€æŸ¥èŠ‚ç‚¹ ${node} çš„é‚»å±…: ${neighbors.join(', ')}`
          })
        }
        
        // é€’å½’è®¿é—®é‚»å±…
        neighbors.forEach(neighbor => {
          generateDFSSteps(neighbor, node)
        })
        
        steps.push({
          action: 'backtrack',
          node: node,
          step: `ä»èŠ‚ç‚¹ ${node} å›æº¯ï¼Œç§»å‡ºè°ƒç”¨æ ˆ`
        })
      }
      
      // ä»èŠ‚ç‚¹Aå¼€å§‹ç”ŸæˆDFSæ­¥éª¤
      generateDFSSteps('A')
      
      steps.push({
        action: 'complete',
        step: 'DFS éå†å®Œæˆï¼æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹éƒ½å·²è®¿é—®ã€‚'
      })
      
      // æ‰§è¡Œæ­¥éª¤
      let stepIndex = 0
      const executeStep = () => {
        if (!this.isPlaying || stepIndex >= steps.length) {
          this.isPlaying = false
          return
        }
        
        const step = steps[stepIndex]
        this.currentDemoStep = step.step
        
        switch (step.action) {
          case 'enter':
            this.nodes[step.node].status = 'visiting'
            break
            
          case 'visit':
            this.nodes[step.node].status = 'visited'
            this.callStack.push(step.node)
            this.currentPath.push(step.node)
            break
            
          case 'mark_edge':
            const edge = this.edges.find(e => 
              (e.from === step.from && e.to === step.to) ||
              (e.from === step.to && e.to === step.from)
            )
            if (edge) {
              edge.visited = true
            }
            break
            
          case 'check_neighbors':
            // é«˜äº®æ˜¾ç¤ºé‚»å±…èŠ‚ç‚¹
            step.neighbors.forEach(neighbor => {
              if (this.nodes[neighbor].status === 'unvisited') {
                this.nodes[neighbor].status = 'candidate'
              }
            })
            break
            
          case 'no_neighbors':
            // æš‚åœä¸€ä¸‹æ˜¾ç¤ºæ²¡æœ‰é‚»å±…çš„çŠ¶æ€
            break
            
          case 'backtrack':
            if (this.callStack.length > 0) {
              this.callStack.pop()
            }
            // å°†å€™é€‰èŠ‚ç‚¹çŠ¶æ€é‡ç½®
            Object.values(this.nodes).forEach(node => {
              if (node.status === 'candidate') {
                node.status = 'unvisited'
              }
            })
            break
            
          case 'complete':
            this.isPlaying = false
            // é«˜äº®æ‰€æœ‰è®¿é—®è¿‡çš„èŠ‚ç‚¹
            Object.values(this.nodes).forEach(node => {
              if (node.status === 'visited') {
                node.status = 'completed'
              }
            })
            break
        }
        
        stepIndex++
        const delay = step.action === 'check_neighbors' ? 1500 : (2000 / this.playSpeed)
        this.demoTimer = setTimeout(executeStep, delay)
      }
      
      executeStep()
    },
    
    // ç»ƒä¹ ç›¸å…³æ–¹æ³•
    initPractice() {
      // å¤åˆ¶æ¼”ç¤ºå›¾çš„ç»“æ„ç”¨äºç»ƒä¹ 
      this.practiceNodes = JSON.parse(JSON.stringify(this.nodes))
      this.practiceEdges = JSON.parse(JSON.stringify(this.edges))
      
      // æ„å»ºç»ƒä¹ å›¾çš„é‚»æ¥è¡¨
      this.practiceGraph = {}
      Object.keys(this.practiceNodes).forEach(node => {
        this.practiceGraph[node] = []
      })
      
      this.practiceEdges.forEach(edge => {
        this.practiceGraph[edge.from].push(edge.to)
        this.practiceGraph[edge.to].push(edge.from)
      })
      
      // ç”Ÿæˆæ­£ç¡®çš„DFSåºåˆ—
      const visited = new Set()
      const sequence = []
      
      const generateSequence = (node) => {
        visited.add(node)
        sequence.push(node)
        
        const neighbors = this.practiceGraph[node]
          .filter(neighbor => !visited.has(neighbor))
          .sort() // æŒ‰å­—æ¯é¡ºåºæ’åºï¼Œç¡®ä¿ä¸€è‡´æ€§
        
        neighbors.forEach(neighbor => {
          generateSequence(neighbor)
        })
      }
      
      generateSequence('A')
      this.expectedSequence = sequence
      
      // é‡ç½®ç»ƒä¹ çŠ¶æ€
      Object.values(this.practiceNodes).forEach(node => {
        node.status = 'unvisited'
      })
      this.practiceEdges.forEach(edge => {
        edge.visited = false
      })
      
      this.userSequence = []
      this.practiceProgress = 0
      this.feedbackMessage = 'ç‚¹å‡»èµ·å§‹èŠ‚ç‚¹ A å¼€å§‹ç»ƒä¹ '
      this.feedbackType = 'info'
    },
    
    onNodeClick(node) {
      if (node.status === 'visited') {
        this.feedbackMessage = 'è¯¥èŠ‚ç‚¹å·²ç»è®¿é—®è¿‡äº†ï¼'
        this.feedbackType = 'warning'
        return
      }
      
      const expectedNode = this.expectedSequence[this.userSequence.length]
      
      if (node.label === expectedNode) {
        // æ­£ç¡®çš„é€‰æ‹©
        node.status = 'visited'
        this.userSequence.push(node.label)
        this.practiceProgress = (this.userSequence.length / this.expectedSequence.length) * 100
        
        if (this.userSequence.length === this.expectedSequence.length) {
          this.feedbackMessage = 'æ­å–œï¼ä½ å·²ç»å®Œæˆäº†DFSç»ƒä¹ ï¼'
          this.feedbackType = 'success'
          this.practiceStatus = 'success'
        } else {
          this.feedbackMessage = `å¾ˆå¥½ï¼ç»§ç»­è®¿é—®ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚`
          this.feedbackType = 'success'
        }
      } else {
        // é”™è¯¯çš„é€‰æ‹©
        this.feedbackMessage = `é”™è¯¯ï¼æŒ‰ç…§DFSè§„åˆ™ï¼Œåº”è¯¥å…ˆè®¿é—®èŠ‚ç‚¹ ${expectedNode}`
        this.feedbackType = 'error'
      }
    },
    
    resetPractice() {
      this.initPractice()
    },
    
    showHint() {
      const nextNode = this.expectedSequence[this.userSequence.length]
      this.feedbackMessage = `æç¤ºï¼šä¸‹ä¸€ä¸ªåº”è¯¥è®¿é—®çš„èŠ‚ç‚¹æ˜¯ ${nextNode}`
      this.feedbackType = 'info'
    },
    
    completeLearning() {
      this.$message.success('æ­å–œå®ŒæˆDFSå­¦ä¹ ï¼')
      this.$router.push('/')
    },
    
    // å²›å±¿æ•°é‡æ¼”ç¤ºæ–¹æ³•
    loadExample() {
      this.resetIslandDemo()
      this.islandGrid = JSON.parse(JSON.stringify(this.examples[this.selectedExample]))
      this.initIslandArrays()
    },
    
    initIslandArrays() {
      const rows = this.islandGrid.length
      const cols = this.islandGrid[0].length
      
      this.islandVisiting = Array(rows).fill().map(() => Array(cols).fill(false))
      this.islandVisited = Array(rows).fill().map(() => Array(cols).fill(false))
    },
    
    startIslandDemo() {
      this.isIslandPlaying = true
      this.resetIslandDemo(true)
      this.generateIslandDemoSteps()
      this.executeIslandDemoSteps()
    },
    
    pauseIslandDemo() {
      this.isIslandPlaying = false
      if (this.islandDemoTimer) {
        clearTimeout(this.islandDemoTimer)
      }
    },
    
    resetIslandDemo(fromStart = false) {
      if (!fromStart) {
        this.isIslandPlaying = false
      }
      
      if (this.islandDemoTimer) {
        clearTimeout(this.islandDemoTimer)
      }
      
      this.islandCount = 0
      this.currentIslandPosition = '(0, 0)'
      this.currentIslandAction = 'å‡†å¤‡å¼€å§‹æ¼”ç¤º...'
      this.islandCallStack = []
      this.islandCurrentStepIndex = 0
      this.islandDemoSteps = []
      
      // é‡æ–°åŠ è½½ç¤ºä¾‹æ•°æ®
      this.islandGrid = JSON.parse(JSON.stringify(this.examples[this.selectedExample]))
      this.initIslandArrays()
    },
    
    generateIslandDemoSteps() {
      const grid = JSON.parse(JSON.stringify(this.examples[this.selectedExample]))
      const steps = []
      const m = grid.length
      const n = grid[0].length
      let count = 0
      
      // ç”Ÿæˆæ¼”ç¤ºæ­¥éª¤
      for (let i = 0; i < m; i++) {
        for (let j = 0; j < n; j++) {
          steps.push({
            type: 'check',
            row: i,
            col: j,
            value: grid[i][j],
            message: `æ£€æŸ¥ä½ç½® (${i}, ${j})ï¼Œå€¼ä¸º '${grid[i][j]}'`
          })
          
          if (grid[i][j] === '1') {
            count++
            steps.push({
              type: 'found_island',
              row: i,
              col: j,
              count: count,
              message: `å‘ç°æ–°å²›å±¿ï¼å²›å±¿æ•°é‡: ${count}`
            })
            
            // ç”ŸæˆDFSæ­¥éª¤
            this.generateDFSSteps(grid, i, j, steps)
          }
        }
      }
      
      steps.push({
        type: 'complete',
        count: count,
        message: `æ¼”ç¤ºå®Œæˆï¼æ€»å…±æ‰¾åˆ° ${count} ä¸ªå²›å±¿`
      })
      
      this.islandDemoSteps = steps
    },
    
    generateDFSSteps(grid, startRow, startCol, steps) {
      const directions = [[-1, 0], [1, 0], [0, -1], [0, 1]]
      const dirNames = ['ä¸Š', 'ä¸‹', 'å·¦', 'å³']
      
      const dfs = (row, col) => {
        // è¾¹ç•Œæ£€æŸ¥
        if (row < 0 || row >= grid.length || col < 0 || col >= grid[0].length || grid[row][col] !== '1') {
          steps.push({
            type: 'dfs_return',
            row: row,
            col: col,
            message: `ä½ç½® (${row}, ${col}) è¶Šç•Œæˆ–ä¸æ˜¯é™†åœ°ï¼Œè¿”å›`
          })
          return
        }
        
        // è¿›å…¥å½“å‰ä½ç½®
        steps.push({
          type: 'dfs_enter',
          row: row,
          col: col,
          message: `DFS è¿›å…¥ä½ç½® (${row}, ${col})`
        })
        
        // æ ‡è®°ä¸ºå·²è®¿é—®
        steps.push({
          type: 'dfs_mark',
          row: row,
          col: col,
          message: `æ ‡è®°ä½ç½® (${row}, ${col}) ä¸ºå·²è®¿é—®`
        })
        
        grid[row][col] = '0' // æ ‡è®°ä¸ºå·²è®¿é—®
        
        // é€’å½’è®¿é—®å››ä¸ªæ–¹å‘
        for (let i = 0; i < 4; i++) {
          const newRow = row + directions[i][0]
          const newCol = col + directions[i][1]
          
          steps.push({
            type: 'dfs_explore',
            row: newRow,
            col: newCol,
            direction: dirNames[i],
            message: `æ¢ç´¢${dirNames[i]}æ–¹å‘: (${newRow}, ${newCol})`
          })
          
          dfs(newRow, newCol)
        }
      }
      
      dfs(startRow, startCol)
    },
    
    executeIslandDemoSteps() {
      if (!this.isIslandPlaying || this.islandCurrentStepIndex >= this.islandDemoSteps.length) {
        this.isIslandPlaying = false
        return
      }
      
      const step = this.islandDemoSteps[this.islandCurrentStepIndex]
      this.processIslandStep(step)
      
      this.islandCurrentStepIndex++
      
      // ç»§ç»­ä¸‹ä¸€æ­¥
      this.islandDemoTimer = setTimeout(() => {
        this.executeIslandDemoSteps()
      }, 1000) // 1ç§’é—´éš”
    },
    
    processIslandStep(step) {
      this.currentIslandAction = step.message
      
      switch (step.type) {
        case 'check':
          this.currentIslandPosition = `(${step.row}, ${step.col})`
          break
          
        case 'found_island':
          this.islandCount = step.count
          this.currentIslandPosition = `(${step.row}, ${step.col})`
          break
          
        case 'dfs_enter':
          this.currentIslandPosition = `(${step.row}, ${step.col})`
          if (step.row >= 0 && step.row < this.islandVisiting.length && 
              step.col >= 0 && step.col < this.islandVisiting[0].length) {
            this.islandVisiting[step.row][step.col] = true
            this.islandCallStack.push({ row: step.row, col: step.col })
          }
          break
          
        case 'dfs_mark':
          if (step.row >= 0 && step.row < this.islandGrid.length && 
              step.col >= 0 && step.col < this.islandGrid[0].length) {
            this.islandGrid[step.row][step.col] = '0'
            this.islandVisited[step.row][step.col] = true
            this.islandVisiting[step.row][step.col] = false
          }
          break
          
        case 'dfs_explore':
          this.currentIslandPosition = `(${step.row}, ${step.col})`
          break
          
        case 'dfs_return':
          if (this.islandCallStack.length > 0) {
            this.islandCallStack.pop()
          }
          break
          
        case 'complete':
          this.currentIslandAction = step.message
          this.islandCallStack = []
          break
      }
    }
  },
  
  beforeUnmount() {
    if (this.demoTimer) {
      clearTimeout(this.demoTimer)
    }
    if (this.islandDemoTimer) {
      clearTimeout(this.islandDemoTimer)
    }
  }
}
</script>

<style scoped>
* {
  box-sizing: border-box !important;
}

body, html {
  overflow-x: hidden !important;
}
.dfs-learning {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  overflow-x: hidden;
  box-sizing: border-box;
}

.learning-header {
  margin-bottom: 30px;
  background: rgba(66, 140, 255, 0.35);
  padding: 30px;
  border-radius: 20px;
  backdrop-filter: blur(20px);
  border: 1px solid rgba(66, 140, 255, 0.4);
  box-shadow: 0 16px 40px rgba(66, 140, 255, 0.25);
}

.language-selector {
  text-align: center;
  margin-bottom: 20px;
}

.step-content {
  margin-bottom: 20px;
}

.intro-card, .code-card, .visualization-card, .practice-card {
  background: rgba(66, 140, 255, 0.35);
  border-radius: 20px;
  padding: 30px;
  backdrop-filter: blur(20px);
  border: 1px solid rgba(66, 140, 255, 0.4);
  box-shadow: 0 16px 40px rgba(66, 140, 255, 0.25);
}

.intro-card h2, .code-card h2, .visualization-card h2, .practice-card h2 {
  color: white;
  margin-bottom: 20px;
  font-size: 28px;
  text-align: center;
  font-weight: 700;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.concept-section h3 {
  color: rgba(255, 255, 255, 0.95);
  margin: 20px 0 10px 0;
  font-size: 20px;
  font-weight: 600;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

.concept-section ul {
  margin: 15px 0;
  padding-left: 20px;
}

.concept-section li {
  margin: 8px 0;
  line-height: 1.6;
  color: rgba(255, 255, 255, 0.9);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.trilogy {
  display: flex;
  gap: 20px;
  margin: 20px 0;
}

.trilogy-item {
  flex: 1;
  display: flex;
  align-items: flex-start;
  gap: 15px;
  padding: 20px;
  background: linear-gradient(135deg, #569aff 0%, #428cff 50%, #2267e6 100%);
  border-radius: 15px;
  color: white;
  border: 1px solid rgba(66, 140, 255, 0.5);
  box-shadow: 0 8px 24px rgba(66, 140, 255, 0.3);
}

.step-number {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
  flex-shrink: 0;
}

.step-content h4 {
  margin: 0 0 10px 0;
  font-size: 16px;
}

.step-content p {
  margin: 0;
  font-size: 14px;
  opacity: 0.9;
  line-height: 1.4;
}

.code-container {
  margin: 20px 0;
}

.code-block {
  background: rgba(0, 0, 0, 0.7);
  color: #e2e8f0;
  padding: 20px;
  border-radius: 15px;
  font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
  font-size: 14px;
  line-height: 1.5;
  overflow-x: auto;
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
}

.code-explanation-details {
  margin-top: 30px;
}

.explanation-item {
  display: flex;
  align-items: flex-start;
  gap: 15px;
  margin: 15px 0;
  padding: 15px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.explanation-number {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: linear-gradient(135deg, #ffb366, #ff9a56);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  flex-shrink: 0;
  box-shadow: 0 4px 12px rgba(255, 179, 102, 0.2);
}

.explanation-content h4 {
  margin: 0 0 5px 0;
  color: white;
  font-weight: 600;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

.explanation-content p {
  margin: 0;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.5;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.demo-controls {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(66, 140, 255, 0.4);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(66, 140, 255, 0.5);
}

.demo-area {
  display: flex;
  gap: 30px;
}

.graph-container {
  flex: 1;
}

.graph-svg, .practice-svg {
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 15px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 24px rgba(255, 107, 53, 0.2);
}

.edge {
  stroke: #bdc3c7;
  stroke-width: 2;
  transition: all 0.3s ease;
}

.edge.visited {
  stroke: #ff6b35;
  stroke-width: 3;
}

.node {
  fill: #ecf0f1;
  stroke: #bdc3c7;
  stroke-width: 2;
  transition: all 0.3s ease;
}

.node.visiting {
  fill: #ffeb3b;
  stroke: #ffc107;
  animation: pulse 1s infinite;
}

.node.visited {
  fill: #4caf50;
  stroke: #388e3c;
}

.node.candidate {
  fill: #2196f3;
  stroke: #1976d2;
  animation: glow 1.5s ease-in-out infinite alternate;
}

.node.completed {
  fill: #9c27b0;
  stroke: #7b1fa2;
  animation: celebrate 0.5s ease-in-out;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

@keyframes glow {
  from { opacity: 0.7; }
  to { opacity: 1; }
}

@keyframes celebrate {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.practice-node {
  cursor: pointer;
}

.practice-node:hover {
  fill: #ddd;
}

.node-text {
  fill: #2c3e50;
  font-weight: bold;
  text-anchor: middle;
  dominant-baseline: middle;
  pointer-events: none;
}

.demo-info {
  width: 300px;
}

.current-step-info, .stack-info, .path-info {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(66, 140, 255, 0.4);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(66, 140, 255, 0.5);
}

.current-step-info h3, .stack-info h3, .path-info h3 {
  margin: 0 0 10px 0;
  color: white;
  font-size: 16px;
  font-weight: 600;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

.stack {
  display: flex;
  flex-direction: column-reverse;
  gap: 5px;
}

.stack-item {
  padding: 8px 12px;
  background: linear-gradient(135deg, #ffb366, #ff9a56);
  color: white;
  border-radius: 8px;
  font-family: 'SF Mono', monospace;
  font-size: 14px;
  box-shadow: 0 2px 8px rgba(255, 179, 102, 0.2);
}

.path {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

.practice-area {
  display: flex;
  gap: 30px;
}

.practice-graph {
  flex: 1;
}

.practice-info {
  width: 300px;
}

.practice-progress, .practice-feedback, .practice-actions {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.feedback-message {
  padding: 10px;
  border-radius: 8px;
  font-weight: 500;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.feedback-message.info {
  background: rgba(33, 150, 243, 0.2);
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.feedback-message.success {
  background: rgba(76, 175, 80, 0.2);
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.feedback-message.error {
  background: rgba(244, 67, 54, 0.2);
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.feedback-message.warning {
  background: rgba(255, 152, 0, 0.2);
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.step-actions {
  text-align: center;
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.3);
}

.step-actions .el-button {
  margin: 0 10px;
}

.practice-instructions {
  margin-bottom: 30px;
}

.practice-rules {
  margin-top: 15px;
}

.practice-rules ul {
  margin: 10px 0;
  padding-left: 20px;
}

.practice-rules li {
  margin: 5px 0;
}

/* å²›å±¿æ•°é‡æ¼”ç¤ºæ ·å¼ */
.island-demo-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
  border-radius: 20px;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

.island-demo-card .el-card__body {
  padding: 30px;
}

.problem-description {
  margin-bottom: 30px;
}

.example-section {
  margin-top: 20px;
}

.example-code {
  background: rgba(0, 0, 0, 0.3);
  color: #fff;
  padding: 15px;
  border-radius: 8px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.4;
  margin: 10px 0;
  overflow-x: auto;
}

.island-visualization {
  margin: 30px 0;
}

.island-controls {
  display: flex;
  align-items: center;
  margin-bottom: 20px;
  padding: 20px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.island-demo-area {
  display: flex;
  gap: 30px;
  align-items: flex-start;
}

.grid-container {
  flex: 1;
  display: flex;
  justify-content: center;
}

.grid {
  display: inline-block;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 8px;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.1);
}

.grid-row {
  display: flex;
}

.grid-cell {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  position: relative;
}

.grid-cell.land {
  background: #4CAF50;
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.grid-cell.water {
  background: #2196F3;
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.grid-cell.visiting {
  background: #FF9800 !important;
  animation: pulse 1s infinite;
  box-shadow: 0 0 20px rgba(255, 152, 0, 0.6);
}

.grid-cell.visited {
  background: #9E9E9E !important;
  opacity: 0.7;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.island-info {
  width: 300px;
}

.island-stats, .dfs-stack {
  margin-bottom: 20px;
  padding: 20px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.island-stats h4, .dfs-stack h4 {
  margin: 0 0 15px 0;
  color: white;
  font-size: 16px;
}

.island-stats p {
  margin: 8px 0;
  color: rgba(255, 255, 255, 0.9);
  font-size: 14px;
}

.island-code-section {
  margin: 30px 0;
}

.island-code-section h3 {
  margin-bottom: 20px;
  color: white;
}

.island-solution {
  margin-top: 30px;
}

.island-solution h3 {
  margin-bottom: 20px;
  color: white;
}

.solution-content {
  color: #333;
  line-height: 1.6;
  word-wrap: break-word;
  overflow-wrap: break-word;
  max-width: 100%;
  box-sizing: border-box;
  overflow: hidden;
}

.solution-content * {
  max-width: 100% !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  box-sizing: border-box !important;
  white-space: normal !important;
}

.solution-content strong {
  display: inline !important;
  max-width: 100% !important;
  word-break: break-all !important;
}

.solution-content p, .solution-content li {
  max-width: 100% !important;
  word-break: break-word !important;
  hyphens: auto !important;
}

.solution-content ol, .solution-content ul {
  max-width: 100% !important;
  padding-left: 20px !important;
  margin: 0 !important;
}

.solution-content h4 {
  color: #2c3e50;
  margin: 15px 0 10px 0;
  font-weight: 600;
}

.solution-content ol {
  padding-left: 20px;
}

.solution-content li {
  margin: 8px 0;
  color: #555;
}

.solution-content p {
  margin: 10px 0;
  color: #666;
}

.el-collapse {
  width: 100% !important;
  max-width: 100% !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
}

.el-collapse-item {
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

.el-collapse-item__wrap {
  width: 100% !important;
  max-width: 100% !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
}

.el-collapse-item__content {
  width: 100% !important;
  max-width: 100% !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
}

.island-solution {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
}
</style>